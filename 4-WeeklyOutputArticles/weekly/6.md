# 跨域

## 什么是跨域

跨域，是指浏览器不能执行其他网站的脚本。它是由浏览器的同源策略造成的，是浏览器对JavaScript实施的安全限制。

同源策略限制了一下行为：

- Cookie、LocalStorage 和 IndexDB 无法读取
- DOM 和 JS 对象无法获取
- Ajax请求发送不出去

## 浏览器是怎么拦截的

浏览器会拦截跨域请求，但是只是拦截返回结果，请求还是会被发送到服务器，那做一些post的操作，被跨域方数据也会被修改到，这样有意义么？



首先，请求因为跨域被拦截后，会改成OPTIONS请求送达服务器，这样服务器就可以知道有人在请求。

至于你说跨域POST也能修改，那因为服务器没对method进行校验，来者不拒，这是你服务器的问题。

正常的API数据操作method不包括OPTIONS，OPTIONS只用来确认允许的操作。



Chrome而言会先发一个options请求去询问服务器是否允许跨域，如果允许则继续发真正的请求，不允许的话就抛出跨域错误



使用CORS的话，分为：简单请求和非简单请求，

- **简单请求：**

  不会发送`options`请求，会直接检查`response`中的`Access-Control-Allow-Origin`等字段，然后浏览器判断是否允许跨域

- **非简单请求：**

  会先通过`options`请求，判断该请求出的页面是否跨域以及是否允许相应来自这个域下的请求，如果`options`返回正确，通常会带上`Access-Control-Allow-Origin`等字段，浏览器会判断这个字段，然后决定否要进行接下来的真正的请求

## 如何解决跨域

- **jsonp**
- **CORS**
- **nginx代理**

