# 请解释可变 (mutable) 和不变 (immutable) 对象的区别

### Mutable对象

在JavaScript中，对象时引用类型的数据，其优点在于频繁的修改对象时都是在原对象的基础上修改，并不需要重新创建，这样就可以有效的利用内存，不会造成内存空间的浪费

JS对象一般都是可变的，因为使用了引用赋值，新的对象简单的引用了原始对象，改变新的对象将影响到原始对象

### Immutable对象

每次修改一个immutable对象都会创建一个新的不可变对象，在新对象上的操作不会影响到原对象的数据

- 简化复杂的功能：不可变性使复杂特性容易实现，比如进行游戏中的时间回溯，日常业务中的撤销和恢复功能。不直接在数据上修改可以让我们追溯并复用游戏的历史记录

- 跟踪数据的改变：如果直接修改数据，那么就很难追踪到数据的改变。跟踪数据的改变需要可变对象可以与之改变之前的版本进行对比，这样整个对象树都需要被遍历一次。

  跟踪不可变数据的变化相对来说就容易多了。如果发现对象变成了一个新对象，那么我们就可以说对象发生改变了

- 确定在react中何时重新渲染：不可变性最主要的优势在于他可以帮助我们在react中创建pure components。我们可以很轻松的确定不可变数据是否发生了改变，从而确定何时对组件进行重新渲染。

### 区别

immutable对象在修改数据时并不会复制一整份数据，而是将变化的节点与未变化的节点的父子关系转移到一个新节点上。而mutable在复制时是`全量`。immutable对象需要通过`set`和`get`来对数据进行读和写。

### 优缺点

> immutable优缺点：
>
> - **优点**
>
>   1.降低mutable带来的复杂度
>
>   ​	引用赋值虽然可以节省内存，但应用复杂之后，可变状态往往会变成噩梦，通常一般的做法是使用	 shallowCopy或者deepCopy来避免被修改，但这样造成了CPU和内存消耗，不过immutable可以很好的解决这些问题
>
>   2.节省内存空间
>
>   ​	以上提到了结构共享，immutable使用这种方式会尽量复用内存，甚至以前使用的对象也可以再次被复用。没有被引用的对象会被垃圾回收
>
>   3.Undo/Redo，Copy/Paste，随意穿越！
>
>   ​	因为每次数据都是不一样的，只要把这些数据放到一个数组里存储起来，想回退到哪里就拿出对应数据即可，很容易开发出撤销重做这种功能
>
>   4.拥抱函数式编程
>
>   ​	immutable（持久化数据结构）本身就是函数式编程中的概念。函数式编程关心数据的映射，命令式编程关心解决问题的步骤，纯函数式编程比面向对象更适用于前端开发，因为只要输入一致，输出必然一致，这样开发的组件更易于调试和组装
>
> - **缺点**
>
>   容易与原生对象混
>
> mutable优缺点：
>
> - **优点**
>
>   频繁的修改对象时都是在原对象的基础上修改，并不需要重新创建，这样可以有效的利用内存，不会造成空间的浪费。
>
> - **缺点**
>
>   在于应用比较复杂的时候，频繁修改数据，风险比较大

### 总结

<font color='red'>mutable 与immutable </font>

<font color='red'>优点 可变类型会减少数据的拷贝次数，从而其效率 要高于immutable 内部数据的不可变导致其更加安全，可以用作多线程的共享对象而不必考虑同步问题 </font>

<font color='red'>缺点 可变类型由于其内部数据可变，所以其风险更大 由于内部数据不可变，所以对其频发修改会产生大量的临时拷贝，浪费空间</font>







​																																





