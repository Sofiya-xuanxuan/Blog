# 深浅拷贝

![深拷贝与浅拷贝](https://i.loli.net/2020/01/04/wTNj4hLZHgs19Dq.png)

<font color='red'>浅拷贝（shallow copy）：只复制指向某个对象的指针，而不复制对象本身，新旧对象共享一块内存</font>

<font color='red'>深拷贝（deep copy）：复制并创建一个一摸一样的对象，不共享内存，修改新对象，旧对象保持不变</font>

### 深拷贝实现的方法

#### 1.通过递归去赋值所有层级属性

```bash
function deepClone(obj){
    let objClone = Array.isArray(obj)?[]:{};
    if(obj && typeof obj==="object"){
        for(key in obj){
            if(obj.hasOwnProperty(key)){
                //判断ojb子元素是否为对象，如果是，递归复制
                if(obj[key]&&typeof obj[key] ==="object"){
                    objClone[key] = deepClone(obj[key]);
                }else{
                    //如果不是，简单复制
                    objClone[key] = obj[key];
                }
            }
        }
    }
    return objClone;
}    
let a=[1,2,3,4],
    b=deepClone(a);
a[0]=2;
console.log(a,b);
```

#### 2.通过JSON的parse和stringify方法

不能拷贝函数，但用在拷贝数据库数据时，不影响，因为数据库没有函数，所以推荐使用。

<font color='red'>其原理是：先将对象转换为字符串、再转换成对象，此时地址一定发生了变化，所以可以实现浅拷贝。</font>

```bash
function deepClone(obj){
    let _obj = JSON.stringify(obj),
        objClone = JSON.parse(_obj);
    return objClone
} 
```

#### 3.通过JQuery的$.extend方法

```bash
$.extend( [deep ], target, object1 [, objectN ] )
#例如：
var obj = {a:{name:"kaiqin",age:19}};
var obj1 = {b:{name:"wang",age:19}};
var obj2 = $.extend(true,{},obj,obj1);
obj2.a.name="zhang";
console.log(obj2)
console.log(obj)
```

#### 4.Object.create()方法——ES5

可以实现深拷贝

### 浅拷贝实现的方法

#### 1.Object.assign()——ES6

将第二个参数合并到第一个对象里

```bash
var obj = {a:{name:"kaiqin",age:19}};
var obj1 = Object.assign({},obj);
obj1.a.name="wang"
console.log(obj1)
console.log(obj)
```

#### 2.ES6扩展运算符（...）

```bash
const obj1 = {
  a: {
  	name: 'sofiya'
  }
};
const obj2 = {
	...obj1
};

obj2.a.name = 'qiaoxu'

console.log(obj1);//qiaoxu
```

#### 3.for…in循环

```bash
var obj = { a: {name:"kaiqin",age:19 } } ;
var obj2 = {a:1,b:2,c:3};
//多层
function copy(obj){
      var newObj = {};
      for(var key in obj){
            newObj[key] = obj[key];
       }
return newObj;
}
```

#### 4.通过JQuery的$.extend方法

第一个参数不写的情况下，默认为false，为浅拷贝

```bash
var obj = {a:{name:"kaiqin",age:19}};
var obj1 = {b:{name:"wang",age:19}};
 
var obj2 = $.extend({},obj,obj1)
obj2.a.name="zhang";
console.log(obj2)
console.log(obj)
```

​																																																				

​																																	







